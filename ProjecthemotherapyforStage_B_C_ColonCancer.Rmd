---
title: "eH705 Term Project"
subtitle: "Term Project"
author:
  name: Neha Kalra, Msc eHealth Candidate 
  affiliation: eH705 | DeGroote School of Business, McMaster University
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  html_document: 
    number_sections: TRUE
    fig_caption: TRUE
    code_folding: hide
    toc: yes
    toc_float: 
      toc_collapsed: true
    theme: readable
---

```{r echo=FALSE, message=FALSE}
# include this code chunk as-is to set options
knitr::opts_chunk$set(comment=NA, prompt=TRUE, echo = TRUE, message = FALSE, warning = FALSE, error = FALSE)
options(max.print = 10000)
options(scipen = 999)
library(Rcmdr)
library(car)
library(RcmdrMisc)
```
```{r "basic_packages" }
pacman::p_load(psych, xray , ggplot2, texreg, DT, excelR, dplyr, wrapr,
               sjmisc, sjlabelled, sjstats, sjPlot, dplyr, forcats,
               knitr, kableExtra, captioner )
```  

```{r  "setup", include=FALSE}  
knitr::opts_chunk$set(echo = TRUE, message=FALSE, error=FALSE, warning=FALSE, comment=NA)
pacman::p_load( psych, ggplot2, DT,  sjPlot, knitr, DescTools )
```   

```{r "colorize", echo=FALSE, results="hide"}
colorize <- function(x, color) {
  if (knitr::is_latex_output()) {
    sprintf("\\textcolor{%s}{%s}", color, x)
  } else if (knitr::is_html_output()) {
    sprintf("<span style='color: %s;'>%s</span>", color, 
      x)
  } else x
}
``` 

```{r  include=FALSE, echo=FALSE}
fig_nums <- captioner(prefix="Figure ", auto_space=FALSE, levels = 1, type = c("n", "n", "n"), infix = ".")
tab_nums <- captioner(prefix="Table ",  auto_space=FALSE, levels = 1, type = c("n", "n", "n"), infix = ".")

tab_nums("data_table", "Table  ",  display="cite")
fig_nums("roc_ggplot", "The  ",  display="cite")
 
citef <- pryr::partial(tab_nums, display = "cite")
```   

```{r  include=FALSE, echo=FALSE}
bump(fig_nums, level=1)
bump(tab_nums, level=1)
```   

<style>
p.caption {
  font-size: 0.9em;
  font-style: italic;
  color: grey;
  margin-right: 10%;
  margin-left: 10%;  
  text-align: center;
}
</style>


***

# Background & Data Attributes

These are data (colon_s) are from one of the first successful trials of adjuvant chemotherapy for colon cancer. Levamisole is a low-toxicitycompound previously used to treat worm infestations in animals; 5-FU is a moderately toxic (as these things go) chemotherapy agent. There are two records per person, one for recurrence and one for death 

* id:	id 

* study:	1 for all patients 

* rx:	Treatment - Obs(ervation), Lev(amisole), Lev(amisole)+5-FU 

* sex:	1=male 

* age:	in years 

* obstruct: obstruction of colon by tumour 

* perfor:	perforation of colon 

* adhere:	adherence to nearby organs 

* nodes:	number of lymph nodes with detectable cancer 

* status:	censoring status 

* differ:	differentiation of tumour (1=well, 2=moderate, 3=poor) 

* extent:	Extent of local spread (1=submucosa, 2=muscle, 3=serosa, 4=contiguous structures) 

* surg:	time from surgery to registration (0=short, 1=long) 

* node4:	more than 4 positive lymph nodes 

* time:	days until death 

* etype:	1=recurrence,2=death 

***
# Objectives of this Report

<add here>

***
 
# Read Data

Data is read using the dataset provided with the assignment.Below tables shows the dataset.

The relevant variables are:

* Health: Percentage of government expenditures directed towards healthcare
* Cell: Cell phone subscriptions (per 100 people)

The dataset contains total of **77 observations**.

```{r}
wh <- read.csv("C:/Users/drnkalra/Documents/R E705/Term Project/colon_s.csv")
wh%>% datatable(rownames = TRUE, filter="top", options = list(pageLength = 7, scrollX=T, Caption ='Tab 1'))  
```
***

# Missing Values and Treatment

In this section, the total count of missing values in each column is identified. Since the total count of NA is less than 5%, we will not treat the missing values. *Note - Zeros are not treated as part of treating missing values as zeros are one of the valid response outputs.*

```{r}
MD <- colSums(is.na(wh))
library(kableExtra)
MD %>%
  kable(caption = "Table 3: Total count of NA for each variable") %>%
   kable_styling( bootstrap_options = "striped", full_width = F, position = "left", fixed_thead = T) 
```

<style>
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">

Few observations looking at the data in graphs above:

* Below are the columns identified with NA:
   * Obstruct - 21
   * nodes - 18
   * differ - 23
   * surg - 17
   * loccomp -20
   * mort_5yr - 14
* Since the total count of NA is less than 5%, we will not treat the missing values.
  
</div>

*** 

# Exploring the distribution of the data

Below tree diagram shows:

* Total number of observations- 929
* 33% of the observations are for patients who were given levamisole (Lev).
* 33% were given levamisole + fluorouracil (Lev +5FU)
* 34% constitutes the controls group.
* there is almost equal distribution of male and females in both the groups (Lev and Lev+5FU)
* Majority of the patients belong to the age group of 60+ followed by 40-59 and <40 years.

```{r echo=FALSE, , fig.align="center", fig.width=6, fig.height=6, fig.cap="Figure 2:add"}
library(vtree)
vtree(wh, c("rx.factor", "sex.factor", "age.factor"), horiz = FALSE, fillcolor = c(restecg = "#e7d4e8", 
  cp = "#99d8c9"), keep = list(restecg = c("ST-T abnormality")))
```
**Frequencies and percentages by Sex**

Below table shows the distribution of sexes in the different treatment therapies
```{r}
x<- sjt.xtab(wh$rx.factor, wh$sex.factor, show.col.prc = TRUE,
             CSS = list(css.table = "border: 2px solid;",
                    css.tdata = "border: 1px solid;"))
x
```
<br>
**Frequencies and percentages by Age Group**

```{r}
y<- sjt.xtab(wh$rx.factor, wh$age.factor, show.col.prc = TRUE,
             CSS = list(css.table = "border: 2px solid;",
                    css.tdata = "border: 1px solid;"))
y
```
<br>
**Frequencies and percentages by obstruction**

```{r}
z<- sjt.xtab(wh$rx.factor, wh$obstruct.factor, show.col.prc = TRUE,
             CSS = list(css.table = "border: 2px solid;",
                    css.tdata = "border: 1px solid;"))
z
```
<br>
**Frequencies and percentages by Perforance**

```{r}
per<- sjt.xtab(wh$rx.factor, wh$perfor.factor, show.col.prc = TRUE,
             CSS = list(css.table = "border: 2px solid;",
                    css.tdata = "border: 1px solid;"))
per
```

obstruct.factor
</div>

&nbsp;
<hr />
<p style="text-align: center;">A work by Neha Kalra</a></p>
<p style="text-align: center;"><span style="color: #808080;"><em>kalran4@mcmaster.ca</em></span></p>

&nbsp;

